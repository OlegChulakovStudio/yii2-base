# Конфигурация приложения

Для облегчения конфигурации приложения на момент запуска можно воспользоваться
конфигуратором приложения с кешированием собранной конфигурации. Конфигуратор собирает
все файлы в един массив и в последующем извлекает его из кеша. На случай возможного
изменения конфигурации происходит дополнительная инвалидация файлов конфигурации
с возможностью указать дополнительные файлы, влияющие на изменение конфигурации.

Процедура инвалидации и получения конфигурации из кеша примерно в 5 раз быстрее
и экономичнее по ресурсам, чем стандартный подход к сбору конфигурации.

## Настройка

В `index.php` вместо стандартного подхода внедрения конфигурации необходимо заменить
`ArrayHelper::merge` на входящий в комплект с компонентом конфигуратор.

Стандартный подход:
```
$config = yii\helpers\ArrayHelper::merge(
    require __DIR__ . '/../../common/config/main.php',
    require __DIR__ . '/../../common/config/main-local.php',
    require __DIR__ . '/../config/main.php',
    require __DIR__ . '/../config/main-local.php'
);
```

С конфигуратором:
```
$config = \chulakov\base\config\Configurator::config([
    '@common/config/main.php',
    '@common/config/main-local.php',
    '@app/config/main.php',
    '@app/config/main-local.php'
]);
```

## Настройки окружения

Если в приложении используется настройка окружения через дополнительные компоненты,
изменение конфигурации которых так же влияет на конфигурацию, можно дополнительно
внести настройку всех файлов окружения, изменение которых так же инвалидирует кеш.

```
$config = \chulakov\base\config\Configurator::config([
    ...
], '@common/config/serv.env');

// Или зависимость от нескольких файлов

$config = \chulakov\base\config\Configurator::config([
    ...
], [
    '@common/config/serv.env',
    '@app/config/app.env'
]);
```

## Настройки кеширования

Если настройки кеша не удовлетворяют необходимому всем требованиям, можно повлиять
на них при конфигурации:

```
$config = \chulakov\base\config\Configurator::config([
    ...
], null, '@app/runtime/app-config.json', 3600);
```
